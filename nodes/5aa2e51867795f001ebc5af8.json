{
  "_id": "5aa2e51867795f001ebc5af8",
  "nodeId": "5a8e6c8e974a57006dd9a5bc",
  "type": "react_component:0.0.1:local:98912hd89",
  "data": {
    "author": "-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCcuXovU+RZy85KMqLakYSH1mdV\nWdpEUtgcXUyGyU5hVeTO7BkV/kxeC2upcxOwNnrBOdsvHI3nrrILgt90/hCSHKzx\nhOFLREorGoKtSEHxI7/SnzzlWtV3gT/IP5GVHIyvuJBx3hCti0dH55DZG8iMGZ2y\ncGpV73Dez3hHmeBh6wIDAQAB\n-----END PUBLIC KEY-----",
    "version": "2",
    "key": "3ae95ba5-2d74-4fa4-846d-768b503c398b",
    "code": "(()=>{\n  return new Promise(async (resolve,reject)=>{\n    try {\n      \n      const AceEditor = universe.AceEditor;\n      const ReactResizeDetector = universe.ReactResizeDetector;\n      const RecreateChildOnPropsChange = universe.RecreateChildOnPropsChange;\n      \n      const Router = universe.ReactRouterDomRouter;\n      const Route = universe.ReactRouterDomRoute;\n      const Switch = universe.ReactRouterDomSwitch;\n      \n      class EmbeddedComponent extends React.Component {\n        constructor(props){\n          super(props);\n        }\n        \n        render(){\n          return (\n            <div>\n              embeddedComponenthere\n            </div>\n          )\n        }\n      }\n      \n      class ErrorComponent extends React.Component {\n        constructor(props){\n          super(props);\n        }\n        render(){\n          return (\n            <div>\n              ErrorLoading\n            </div>\n          )\n        }\n      }\n      \n      class mycomponent extends React.Component {\n        constructor(props){\n          super(props);\n          this.state = {\n            developerComponent: null,\n          }\n        }\n        \n        componentDidMount(){\n          \n          return new Promise(async (resolve,reject)=>{\n            \n            // Fetch default nodes (Language NodeChain, Identity, etc.) \n            this.fetchDefaultNodes();\n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'DefaultLayout'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                defaultLayout: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component4');\n            }\n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainDeveloperComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                developerComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component4');\n            }\n            \n            \n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainCodeUpdateComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                codeUpdateComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new MainCodeUpdateComponent');\n            }\n            \n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainCommandsComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                commandsComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component4');\n            }\n            \n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainUserComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                userViewComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component5');\n            }\n            \n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainMessagesComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                messagesComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component6');\n            }\n            \n            try {\n                \n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainNodeChainsComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                nodeChainsComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component7');\n            }\n            \n            try {\n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainMyAppStoreComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                myAppStoreComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component8');\n            }\n            \n            try {\n              let result = await universe.searchMemory({\n                filter: {\n                  sqlFilter: {\n                    type: 'react_component:0.0.1:local:98912hd89',\n                    data: {\n                      internalId: 'MainExternalAppStoreComponent'\n                    }\n                  }\n                }\n              });\n              let componentNode = await universe.runInVM(result[0],{});\n              this.setState({\n                externalAppStoreComponent: componentNode.data\n              })\n            } catch(err){\n              console.error('Failed getting new component9');\n            }\n            \n          });\n          \n        }\n        \n        @autobind\n        async fetchDefaultNodes(){\n          // used elsewhere in the app \n          \n          // Cloud Second's main identity, from internal \n          let ExternalIdentityNodes = await universe.searchMemory({\n            filter: {\n              sqlFilter: {\n                type: 'external_identity:0.0.1:local:8982f982j92',\n                data: {\n                  commonName: 'main'\n                }\n              }\n            }\n          });\n          let OwnerSecondExternalIdentityNode = ExternalIdentityNodes[0];\n          this.props.setState({\n            OwnerSecondExternalIdentityNode\n          });\n          \n          // Language NodeChain \n          // - from ExternalIdentityNodes \n          // - this is the default \"find a node on the remote\" action \n          let response = await universe.loadAndRunCapability('TalkToSecond',{},{\n            type: 'standard_capability_action:0.0.1:local:298j291bs',\n            data: {\n              action: 'send',\n              options: {\n                ExternalIdentityNode: OwnerSecondExternalIdentityNode,\n                RequestNode: {\n                  type: 'run_action_sequence:0.0.1:local:293fh8239hsdf23f',\n                  data: {\n                    actions: [\n                      {\n                        matchActionType: 'search_internal_datasource:0.0.1:local:2h3ufih8s9h2f',\n                        dataForAction: {\n                          type: 'standard_query_request:0.0.1:local:65723f2khfds',\n                          data: {\n                            matchFunctionNode: {\n                              // query here!\n                              // action_pointer:0.0.1:local:238972ncr\n                              type: 'code_miniverse:0.0.1:local:2782fh8823s23',\n                              data: {\n                                code: `(()=>{\n                                  // Action \n                                  // - childNode common_type:0.0.1:local:298fh29h2323f == \"action\" \n                                  \n                                  let inputNode = INPUT.data.inputNode;\n                                  \n                                  // must be root level (TODO, move somewhere sensible?) \n                                  if(inputNode.nodeId){\n                                    return false;\n                                  }\n                                  \n                                  if(inputNode.type.split(':')[0] != 'node_chain_info'){\n                                    return false;\n                                  }\n                                  \n                                  // get our default dev@second nodechain \n                                  if(inputNode.data.username != 'dev@second'){\n                                    return false;\n                                  }\n                                  if(inputNode.data.network != 'test'){\n                                    return false;\n                                  }\n                                  \n                                  return inputNode;\n                                  \n                                })()`\n                              }\n                            },\n                          }\n                        }\n                      }\n                    ]\n                    \n                  }\n                }\n              }\n            }\n          });\n          \n          let LanguageChainNodes = response.data.actionResponses[0].data;\n          let LanguageChainNode = LanguageChainNodes[0];\n          \n          console.log('LanguageChainNode (default)', LanguageChainNode);\n          \n          this.props.setState({\n            LanguageChainNode\n          });\n          \n        }\n        \n        render(){\n          \n          const DeveloperComponent = this.state.developerComponent || ErrorComponent;\n          const CodeUpdateComponent = this.state.codeUpdateComponent || ErrorComponent;\n          const CommandsComponent = this.state.commandsComponent || ErrorComponent;\n          const UserViewComponent = this.state.userViewComponent || ErrorComponent;\n          const NodeChainsComponent = this.state.nodeChainsComponent || ErrorComponent;\n          const MessagesComponent = this.state.messagesComponent || ErrorComponent;\n          \n          const MyAppStoreComponent = this.state.myAppStoreComponent || ErrorComponent;\n          const ExternalAppStoreComponent = this.state.externalAppStoreComponent || ErrorComponent;\n          \n          const DefaultLayout = this.state.defaultLayout || ErrorComponent;\n          \n          return (\n            <Router>\n              <Switch>\n                <DefaultLayout exact path=\"/assistant\" component={CommandsComponent}/>\n                <DefaultLayout exact path=\"/messages\" component={MessagesComponent}/>\n                <DefaultLayout exact path=\"/friends\" component={UserViewComponent}/>\n                <DefaultLayout exact path=\"/nodechains\" component={NodeChainsComponent}/>\n                <DefaultLayout exact path=\"/dev/update\" component={CodeUpdateComponent}/>\n                <DefaultLayout exact path=\"/dev\" component={DeveloperComponent}/>\n                \n                <DefaultLayout exact path=\"/\" component={MyAppStoreComponent}/>\n                <DefaultLayout exact path=\"/appstore\" component={ExternalAppStoreComponent}/>\n              </Switch>\n            </Router>\n          )\n        }\n      }\n      \n      mycomponent = universe.ReactGlobalState(mycomponent);\n      \n      resolve({\n        type: 'react_component:0.0.1:local:98912hd89',\n        data: mycomponent\n      });\n      \n    }catch(err){\n      reject({\n        ERROR: true, \n        err: err.toString()\n      });\n    }\n    \n  })\n\n  \n})()",
    "internalId": "MainComponent"
  },
  "active": true,
  "createdAt": 1520624920893,
  "updatedAt": 1522744076627
}